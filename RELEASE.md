# リリース手順

このプロジェクトでは、GitHub Actionsを使用してタグベースの自動リリースを行います。

## リリースの作成方法

### 1. タグの作成とプッシュ

```bash
# 新しいバージョンのタグを作成
git tag v1.0.0

# タグをリモートリポジトリにプッシュ
git push origin v1.0.0
```

### 2. 自動リリースの実行

タグをプッシュすると、GitHub Actionsが自動的に以下を実行します：

1. **フロントエンドのビルド** - Reactアプリケーションをビルド
2. **マルチプラットフォームバイナリの作成**:
   - Linux AMD64 (`server-linux`)
   - Linux ARM64 (`server-linux-arm64`)
   - Windows AMD64 (`server-windows.exe`)
   - macOS AMD64 (`server-macos-amd64`)
   - macOS ARM64 (`server-macos-arm64`)

3. **リリースアーカイブの作成**:
   - 各プラットフォーム用のtar.gz/zipファイル
   - フロントエンドファイル、README、LICENSE、設定ファイルを含む

4. **GitHub Releaseの作成**:
   - タグ名をバージョンとして使用
   - 全プラットフォーム用のバイナリを添付
   - リリースノートを自動生成

## ローカルでのビルド

### 全プラットフォーム用バイナリの作成

```bash
# フロントエンドをビルド
cd web && npm install && npm run build && cd ..

# 全プラットフォーム用バイナリを作成
make build-all
```

### リリースアーカイブの作成

```bash
# リリース用アーカイブを作成
make create-release-archives
```

## バージョン情報

ビルドされたバイナリには以下の情報が含まれます：

- **Version**: タグ名（例: v1.0.0）
- **Build Time**: ビルド日時（UTC）
- **Git Commit**: コミットハッシュ
- **Go Version**: 使用したGoのバージョン

バージョン情報は `/api/version` エンドポイントで確認できます。

## タグの命名規則

- セマンティックバージョニングを使用: `v1.0.0`, `v1.2.3`, `v2.0.0-beta.1`
- `v` プレフィックスを付ける
- 例: `v1.0.0`, `v1.1.0`, `v2.0.0-rc.1`

## リリースの確認

1. GitHubの「Releases」ページでリリースを確認
2. 各プラットフォーム用のバイナリが正しく添付されているか確認
3. リリースノートが適切に生成されているか確認

## トラブルシューティング

### ビルドが失敗する場合

1. フロントエンドのビルドエラーを確認
2. Goの依存関係を確認: `go mod tidy`
3. GitHub Actionsのログを確認

### リリースが作成されない場合

1. タグが正しくプッシュされているか確認
2. GitHub Actionsの権限設定を確認
3. ワークフローファイルの構文を確認
